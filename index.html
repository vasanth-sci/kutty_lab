<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dozer Lab | Field visualizer </title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.11.0/math.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css">
    <style>
        canvas { width: 100% !important; height: 100% !important; outline: none; }
        .fullscreen-mode {
            position: fixed !important; top: 0 !important; left: 0 !important;
            width: 100vw !important; height: 100vh !important;
            z-index: 100 !important; border-radius: 0 !important; margin: 0 !important;
        }
    </style>
</head>
<body id="mainBody" class="bg-slate-50 text-slate-900 font-sans transition-colors duration-500 overflow-hidden">

<div class="flex flex-col h-screen scale-in overflow-hidden">
    <header class="bg-white border-b px-4 py-3 flex justify-between items-center shadow-sm z-10 dark-target flex-shrink-0">
        <h1 class="text-lg font-bold flex items-center gap-2">
            <span>üê∑</span>
            <span class="bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">Dozer Lab</span>
        </h1>
        <button onclick="toggleDarkMode()" class="p-2 rounded-full bg-slate-100 border border-slate-200" id="themeBtn">üåô</button>
    </header>

    <div class="flex flex-1 flex-col lg:flex-row overflow-y-auto lg:overflow-hidden">
        <aside class="w-full lg:w-80 bg-white border-r p-6 dark-target overflow-y-auto custom-scrollbar">
            <div class="space-y-6">
                <div>
                    <label class="block text-xs font-black text-slate-400 uppercase mb-2">Scalar Field</label>
                    <input id="scalar" value="sin(x) * cos(y)" class="w-full p-3 rounded-xl border border-slate-200 outline-none focus:ring-2 focus:ring-indigo-500 dark-input">
                </div>
                <div>
                    <label class="block text-xs font-black text-slate-400 uppercase mb-2">Vector Field</label>
                    <input id="vector" value="[y, -x]" class="w-full p-3 rounded-xl border border-slate-200 outline-none focus:ring-2 focus:ring-indigo-500 dark-input">
                </div>
                <div>
                    <label class="block text-xs font-black text-slate-400 uppercase mb-2">Color Palette</label>
                    <select id="colorScale" class="w-full p-3 rounded-xl border border-slate-200 bg-white dark-input">
                        <option value="Viridis">Viridis</option>
                        <option value="Hot">Thermal</option>
                        <option value="Cool">Cool</option>
                        <option value="Jet">Jet</option>
                        <option value="Sunset">Sunset (Warm)</option>
                    </select>
                </div>
                <div class="space-y-4">
                    <div>
                        <label class="block text-xs font-black text-slate-400 mb-1">Vector Density: <span id="densityVal" class="text-indigo-600">10</span></label>
                        <input type="range" id="density" min="4" max="25" value="10" class="w-full accent-indigo-600">
                    </div>
                    <div>
                        <label class="block text-xs font-black text-slate-400 mb-1">Arrow Size: <span id="arrowSizeVal" class="text-indigo-600">0.6</span></label>
                        <input type="range" id="arrowSize" min="0.0" max="2.0" step="0.1" value="0.6" class="w-full accent-indigo-600">
                    </div>
                   <div class="flex flex-col gap-1">
    <label class="block text-xs font-black text-slate-400 mb-1">3D Scatter Density: <span id="markerDensityVal">25</span></label>
    <input type="range" id="markerDensity" min="5" max="50" value="25" class="w-full accent-indigo-600">
</div> 
                    <div>
                        <label class="block text-xs font-black text-slate-400 mb-1">Dot Size: <span id="markerSizeVal" class="text-indigo-600">0.15</span></label>
                        <input type="range" id="markerSize" min="0.1" max="1" step="0.01" value="0.45" class="w-full accent-indigo-600">
                    </div>

<div>
    <label class="block text-xs font-black text-slate-400 mb-1">Flow Speed: <span id="flowSpeedVal" class="text-indigo-600">1.0</span></label>
    <input type="range" id="flowSpeed" min="0.1" max="5.0" step="0.1" value="1.0" class="w-full accent-indigo-600">
</div>

<div class="pt-4 border-t border-slate-100 dark:border-slate-800">
    <div class="flex justify-between items-center mb-3">
        <label class="block text-xs font-black text-slate-400 uppercase">Manual Particle</label>
        <button id="clearManualBtn" class="text-slate-400 hover:text-red-500 transition-colors" title="Clear all manual particles">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
            </svg>
        </button>
    </div>
    <div class="grid grid-cols-3 gap-2 mb-3">
        <input id="manualX" type="number" step="0.1" value="0" class="p-2 text-xs rounded-lg border border-slate-200 dark-input" placeholder="X">
        <input id="manualY" type="number" step="0.1" value="0" class="p-2 text-xs rounded-lg border border-slate-200 dark-input" placeholder="Y">
        <input id="manualZ" type="number" step="0.1" value="0" class="p-2 text-xs rounded-lg border border-slate-200 dark-input" placeholder="Z">
    </div>
    <button id="addParticleBtn" class="w-full py-2 bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-bold rounded-xl transition-all shadow-md">
        üìç DROP PARTICLE
    </button>
</div>


                </div>
            </div>
        </aside>

        <main class="flex-1 grid grid-cols-1 lg:grid-cols-2 p-3 gap-3 bg-slate-100 dark-target-bg">
            <div id="scalarCont" class="bg-white dark:bg-slate-900 rounded-3xl overflow-hidden shadow-xl border relative">
                <div class="absolute top-4 left-4 z-10 flex gap-2">
                    <span class="text-[10px] font-bold text-white/70 bg-black/60 px-2 py-1 rounded-full">SCALAR</span>
                    <button onclick="toggleFullScreen('scalarCont')" class="text-[10px] font-bold text-white/70 bg-black/60 px-2 py-1 rounded-full hover:bg-indigo-600">‚õ∂</button>
                </div>
                <div id="scalarLegend" class="absolute top-4 right-4 z-20"></div>
                <div id="scalarPlot" class="w-full h-full"></div>
            </div>
            <div id="vectorCont" class="bg-white dark:bg-slate-900 rounded-3xl overflow-hidden shadow-xl border relative">
                <div class="absolute top-4 left-4 z-10 flex gap-2">
                    <span class="text-[10px] font-bold text-white/70 bg-black/60 px-2 py-1 rounded-full">VECTOR</span>
                    <button onclick="toggleFullScreen('vectorCont')" class="text-[10px] font-bold text-white/70 bg-black/60 px-2 py-1 rounded-full hover:bg-indigo-600">‚õ∂</button>
                     <div class="absolute top-10 right-6 z-10">
    <button id="flowToggle" class="bg-black/60 hover:bg-indigo-600 text-white text-[10px] font-bold px-3 py-2 rounded-full backdrop-blur-md transition-all border border-white/10">
        ‚ú® FLOW: OFF
    </button>
</div>



                </div>
                <div id="vectorLegend" class="absolute top-4 right-4 z-20"></div>
                <div id="vectorPlot" class="w-full h-full"></div>
            </div>
        </main>
    </div>
</div>
<script src="script.js"></script>
</body>
</html>

